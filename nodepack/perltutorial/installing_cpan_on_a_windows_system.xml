<node>
  <doctext>&lt;p&gt;Assuming you have installed ActiveState Perl the following is a guide to
getting CPAN's cpan module install tool working on a Windows XP system with
Visual Studio.&lt;/p&gt;
&lt;h3&gt;Install Visual Studio&lt;sup&gt;1&lt;/sup&gt;&lt;/h3&gt;
&lt;p&gt;First up, CPAN gripes endlessley if you try to run nmake from a path including a space. If
you have Visual Studio installed to its default location in .../Program
Files/... and you are using NTFS then your best bet is to use System Internals'
Junction to create a hard link to the Visual Studio install folder (an alternative is to map a path to a virtual drive using the Windows-native command [http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/subst.mspx?mfr=true|subst] - thanks to [Roy Johnson] for this tip). You can pick
Junction up from
[http://www.sysinternals.com/Utilities/Junction.html]. Run it as:&lt;/p&gt;
&lt;c&gt;
junction c:/vs2003 &quot;C:\Program Files\Microsoft Visual Studio 7&quot;
&lt;/c&gt;
&lt;p&gt;If you are yet to install Visual Studio then you should seriously consider
installing it to a non-default path that doesn't include spaces in the path.&lt;/p&gt;
&lt;h3&gt;Install cygwin&lt;/h3&gt;
&lt;p&gt;Install cygwin from http://cygwin.com/setup.exe. When the setup promts you to
choose a download site you should choose four or so mirrors to help avoid stale
mirror syndrome.&lt;/p&gt;
&lt;p&gt;During the install you should add the following non-default packages:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Archive/unzip&lt;/li&gt;
&lt;li&gt;web/lynx&lt;/li&gt;
&lt;li&gt;web/wget&lt;/li&gt;
&lt;li&gt;net/ncftp&lt;/li&gt;
&lt;li&gt;utils/gnupg&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Note that you can use the View button to toggle between different package
views. &quot;Not Installed&quot; and &quot;Category&quot; are most usefull for this job. Click on
&quot;Skip&quot; to select a package for installation.&lt;/p&gt;
&lt;h3&gt;Installing CPAN&lt;/h3&gt;
&lt;p&gt;Open a command window using &quot;Programs|Microsoft Visual Studio 200x|Visual
Studio Tools|Visual Studio 200x Command Prompt&quot;&lt;sup&gt;2&lt;/sup&gt;&lt;/p&gt;
&lt;p&gt;Append the cygwin bin folder to the search path:&lt;/p&gt;
&lt;c&gt;
set path=%path%;c:\cygwin\bin
&lt;/c&gt;
&lt;p&gt;Run CPAN - just type cpan on the command line and hit enter. The AS Perl
install proivides a batch file on the path that runs the cpan tool.&lt;/p&gt;
&lt;p&gt;The first time cpan is run it wants to go through a configuration process.
Mostly using the default options is fine. I'd recommend using &quot;follow&quot; at the
&quot;Policy on building prerequisites&quot; prompt however.&lt;/p&gt;
&lt;p&gt;The most important thing to check is that the path for nmake is correct and
doesn't include spaces. If you have a default VS install then most likely you
will need to change the path to use the hard link you created with Junction.&lt;/p&gt;
&lt;p&gt;Other than that, just accept the defaults and you are done.&lt;/p&gt;
&lt;h3&gt;TIMTOWTDI&lt;/h3&gt;
&lt;p&gt;During the first airing of this as a meditation a couple of 'see also's were suggested:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;You may be interested in these links: [http://use.perl.org/~Alias/journal/28427|alias offers a metre of beer for a fully working installer] and [http://use.perl.org/~Alias/journal/28462|Stephen Steneker's CamelPack claims the prize]. (suggested by [rhesa])&lt;/li&gt;
&lt;li&gt;[http://vanillaperl.com/|Vanilla Perl] (mentioned by [adamk])&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;sup&gt;1&lt;/sup&gt;Oh, there is a gotcha - things go rather pear shaped if you use VS 2005 to
build against AS Perl 5.8.7 (815) and earlier builds (and possibly against 5.8.8
when it's available) because the binaries generated by VS 2005 do not play with
the VC++ 6 binaries built with an earlier compiler.&lt;/p&gt;
&lt;p&gt;&lt;sup&gt;2&lt;/sup&gt;If you use the command line reguarly it is well worth migrating
the contents of the batch file invoked by this command into your environment.
[demerphq] has written a script to ease the process - see the update to 
[id://289272|this node]&lt;/p&gt;
&lt;div class=&quot;pmsig&quot;&gt;&lt;div class=&quot;pmsig-461912&quot;&gt;
&lt;hr&gt;DWIM is Perl's answer to G&amp;ouml;del
&lt;/div&gt;&lt;/div&gt;</doctext>
  <type_nodetype>956</type_nodetype>
  <node_id>583586</node_id>
  <author_user>461912</author_user>
  <title>Installing CPAN on a Windows system</title>
  <createtime>2006-11-12 15:10:25</createtime>
  <nodeupdated>2006-11-12 10:10:25</nodeupdated>
</node>
